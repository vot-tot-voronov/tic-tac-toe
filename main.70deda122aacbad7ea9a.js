(()=>{"use strict";const t=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)};var e,n=(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),i=function(){function e(t,e,n,i,o,s){this.x=0,this.y=0,this.velX=0,this.velY=0,this.color="rgba(255, 255, 255, 1)",this.size=1,this.x=t,this.y=e,this.velX=n,this.velY=i,this.color=o,this.size=s}return e.prototype.update=function(t,e){this.x+this.size>=t&&(this.velX=-this.velX),this.x-this.size<=0&&(this.velX=-this.velX),this.y+this.size>=e&&(this.velY=-this.velY),this.y-this.size<=0&&(this.velY=-this.velY),this.x+=this.velX,this.y+=this.velY},e.prototype.collisionDetect=function(e){for(var n=0;n<e.length;n++)if(this!==e[n]){var i=this.x-e[n].x,o=this.y-e[n].y;Math.sqrt(i*i+o*o)<this.size/2+e[n].size&&(e[n].color=this.color="rgb("+t(0,255)+","+t(0,255)+","+t(0,255)+")")}},e}(),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.draw=function(t){t.beginPath(),t.lineWidth=7,t.strokeStyle=this.color,t.arc(this.x,this.y,this.size,0,2*Math.PI),t.stroke()},e}(i),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.draw=function(t){t.lineWidth=7,t.lineCap="round",t.strokeStyle=this.color,t.beginPath(),t.moveTo(this.x-this.size,this.y-this.size),t.lineTo(this.x+this.size,this.y+this.size),t.moveTo(this.x+this.size,this.y-this.size),t.lineTo(this.x-this.size,this.y+this.size),t.stroke()},e}(i),r=function(){return r=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function a(e){var n=e.canvasContext,i=e.balls,c=e.crosses,h=document.querySelector(".game-warapper"),l=h.clientWidth,d=h.clientHeight;for(n.fillStyle="rgba(25, 23, 23, 0.5)",n.fillRect(0,0,l,d);i.length<10;){var u=new o(t(0,l),t(0,d),t(-3,3),t(-3,3),"rgb("+t(0,255)+","+t(0,255)+","+t(0,255)+")",t(10,20));i.push(u);var v=new s(t(0,l),t(0,d),t(-3,3),t(-3,3),"rgb("+t(0,255)+","+t(0,255)+","+t(0,255)+")",t(10,20));c.push(v)}for(var m=0;m<i.length;m++)i[m].draw(n),c[m].draw(n),i[m].update(l,d),c[m].update(l,d),i[m].collisionDetect(i),c[m].collisionDetect(c);return requestAnimationFrame(function(){return a(r({},e))})}const c=function(){var t=document.getElementById("bg-canvas"),e=t.getContext("2d"),n=document.querySelector(".game-warapper");t.width=n.clientWidth,t.height=n.clientHeight,new ResizeObserver(function(e){e.forEach(function(e){var n=e.borderBoxSize[0],i=n.inlineSize,o=n.blockSize;t.width=i,t.height=o})}).observe(n),a({canvasContext:e,balls:[],crosses:[]})};var h="Final result: draw!",l=50,d=function(){function t(t){this.boardGame=[],this.checkBoard=[],this.currentPlayer="X",this.winLength=3,this.movesCount=0,this.boardDimension=3,this.gameScores={X:0,O:0},this.canvasContext=t}return t.prototype.setBoardDimension=function(t){this.boardDimension=t},t.prototype.resetGameScores=function(){this.gameScores={X:0,O:0}},t.prototype.drawBoard=function(t){var e=t.lineWidth,n=void 0===e?7:e,i=t.lineStyle,o=void 0===i?"yellow":i,s=this.canvasContext.canvas.getBoundingClientRect(),r=s.right-s.left,a=r-5,c=r/this.boardDimension;this.canvasContext.clearRect(0,0,this.canvasContext.canvas.width,this.canvasContext.canvas.height),this.canvasContext.lineWidth=n,this.canvasContext.strokeStyle=o,this.canvasContext.lineCap="round",this.canvasContext.beginPath();for(var h=1;h<=this.boardDimension-1;h++)this.canvasContext.moveTo(4,h*c),this.canvasContext.lineTo(a,h*c);for(var l=1;l<=this.boardDimension-1;l++)this.canvasContext.moveTo(l*c,4),this.canvasContext.lineTo(l*c,a);this.canvasContext.stroke(),this.boardDimension<5&&(this.winLength=3),5==this.boardDimension&&(this.winLength=4),this.boardDimension>5&&(this.winLength=5),this.setLineWidth()},t.prototype.setLineWidth=function(){switch(!0){case this.boardDimension<=4:this.canvasContext.lineWidth=7;break;case this.boardDimension>4&&this.boardDimension<=7:this.canvasContext.lineWidth=6;break;default:this.canvasContext.lineWidth=4}},t.prototype.getBoardSizes=function(){var t=this.canvasContext.canvas.getBoundingClientRect(),e=t.right-t.left;return[e/this.boardDimension,e]},t.prototype.initializeBoardSquares=function(){var t=this.getBoardSizes()[0];this.movesCount=0;for(var e=0;e<=this.boardDimension-1;e++){this.boardGame[e]=[],this.checkBoard[e]=[];for(var n=0;n<=this.boardDimension-1;n++)this.boardGame[e][n]={left:Math.round(t*n),top:Math.round(t*e),right:Math.round(t+t*n),bottom:Math.round(t+t*e)},this.checkBoard[e][n]=null}},t.prototype.recalculateBoardGame=function(){for(var t=this.getBoardSizes(),e=t[0],n=t[1],i=0;i<=this.boardDimension-1;i++){this.boardGame[i]=[];for(var o=0;o<=this.boardDimension-1;o++){var s={left:Math.round(e*o),top:Math.round(e*i),right:Math.round(e+e*o),bottom:Math.round(e+e*i)};this.boardGame[i][o]=s;var r=this.checkBoard[i][o];null!==r&&("O"===r?this.drawO(s,n):this.drawX(s))}}},t.prototype.drawX=function(t){var e=this.boardDimension;e>7&&e<=10&&(e=7),this.canvasContext.lineCap="round",this.canvasContext.strokeStyle="red",this.canvasContext.beginPath(),this.canvasContext.moveTo(t.left+l/e,t.top+l/e),this.canvasContext.lineTo(t.right-l/e,t.bottom-l/e),this.canvasContext.moveTo(t.right-l/e,t.top+l/e),this.canvasContext.lineTo(t.left+l/e,t.bottom-l/e),this.canvasContext.stroke()},t.prototype.drawO=function(t,e){var n=e/this.boardDimension,i=t.left+n/2,o=t.top+n/2;this.canvasContext.lineCap="round",this.canvasContext.strokeStyle="#a1e8f5",this.canvasContext.beginPath(),this.boardDimension<=7&&this.canvasContext.arc(i,o,n/2.5,0,2*Math.PI),this.boardDimension>7&&this.boardDimension<=10&&this.canvasContext.arc(i,o,n/2.6,0,2*Math.PI),this.canvasContext.stroke()},t.prototype.checkDraw=function(t){return this.movesCount===t?h:null},t.prototype.checkWinnerFromLastMove=function(t,e){var n=e.row,i=e.col,o=t[n][i];return this.checkDirection(t,n,i,0,1)||this.checkDirection(t,n,i,0,-1)||this.checkDirection(t,n,i,1,0)||this.checkDirection(t,n,i,-1,0)||this.checkDirection(t,n,i,1,1)||this.checkDirection(t,n,i,-1,-1)||this.checkDirection(t,n,i,1,-1)||this.checkDirection(t,n,i,-1,1)?o:this.checkDraw(Math.pow(this.boardDimension,2))},t.prototype.checkDirection=function(t,e,n,i,o){for(var s=t[e][n],r=1,a=1;a<this.winLength;a++){var c=e+a*i,h=n+a*o;if(c<0||c>=this.boardDimension||h<0||h>=this.boardDimension)break;if(t[c][h]!==s)break;r++}for(a=1;a<this.winLength;a++){var l=e-a*i,d=n-a*o;if(l<0||l>=this.boardDimension||d<0||d>=this.boardDimension)break;if(t[l][d]!==s)break;r++}return r>=this.winLength},t.prototype.makeAMove=function(t){var e=this.canvasContext.canvas.getBoundingClientRect(),n=e.right-e.left,i=t.clientX-e.left,o=t.clientY-e.top,s=n/this.boardDimension,r=Math.floor(o/s),a=Math.floor(i/s);if(r>=0&&r<this.boardDimension&&a>=0&&a<this.boardDimension&&null===this.checkBoard[r][a]){this.movesCount++,"X"===this.currentPlayer?(this.drawX(this.boardGame[r][a]),this.checkBoard[r][a]="X",this.currentPlayer="O"):"O"===this.currentPlayer&&(this.drawO(this.boardGame[r][a],n),this.checkBoard[r][a]="O",this.currentPlayer="X");var c=this.checkWinnerFromLastMove(this.checkBoard,{row:r,col:a});return"X"!==c&&"O"!==c||this.gameScores[c]++,{whoWin:c,scores:this.gameScores}}return{whoWin:null,scores:this.gameScores}},t}();const u=d;var v=.75,m=/^\d+$/;c();var p=document.querySelector(".game-warapper"),y=document.getElementById("start3on3"),f=document.getElementById("start5on5"),b=document.getElementById("startNonN"),g=document.querySelector(".board-dimension"),x=document.querySelector(".start-menu"),k=document.querySelector(".canvas-wrapper"),w=document.querySelector(".navigation"),C=document.getElementById("menu-btn"),S=document.getElementById("replay-btn"),D=document.getElementById("score-X"),B=document.getElementById("score-O"),z=document.querySelector(".alert-box"),E=document.querySelector(".alert-box__text"),L=document.getElementById("continue-btn"),M=document.getElementById("tic-tac-toe"),I=new u(M.getContext("2d"));function O(t){var e,n=I.makeAMove(t),i=n.whoWin,o=n.scores;null!==i&&(M.removeEventListener("mouseup",O),e=i,z.style.display="block",E.textContent=e===h?e:"".concat(e," wins!"),L.addEventListener("click",function(){var t=p.clientHeight,e=p.clientWidth,n=Math.min(e,t)*v;I.drawBoard({canvasSize:n}),I.initializeBoardSquares(),M.addEventListener("mouseup",O),z.style.display="none"},{once:!0}),W(o))}function X(t){x.style.display="none",g.style.display="none",k.style.display="block",w.style.display="flex";var e=p.clientHeight,n=p.clientWidth,i=Math.min(n,e)*v;M.width=i,M.height=i,I.setBoardDimension(t),I.resetGameScores(),W(),C.addEventListener("click",function(){w.style.display="none",k.style.display="none",x.style.display="flex",z.style.display="none"}),M.removeEventListener("mouseup",O),S.addEventListener("click",function(){var t=p.clientHeight,e=p.clientWidth,n=Math.min(e,t)*v;I.resetGameScores(),I.drawBoard({canvasSize:n}),I.initializeBoardSquares(),W(),z.style.display="none",M.addEventListener("mouseup",O)}),I.drawBoard({canvasSize:i}),I.initializeBoardSquares(),M.addEventListener("mouseup",O)}function W(t){var e,n;D.textContent="X: ".concat(null!==(e=null==t?void 0:t.X)&&void 0!==e?e:0),B.textContent="O: ".concat(null!==(n=null==t?void 0:t.O)&&void 0!==n?n:0)}new ResizeObserver(function(t){t.forEach(function(t){if(k.checkVisibility()){var e=t.borderBoxSize[0],n=e.inlineSize,i=e.blockSize,o=Math.min(n,i)*v;M.width=o,M.height=o,I.drawBoard({canvasSize:o}),I.recalculateBoardGame()}})}).observe(p),y.addEventListener("click",function(){return X(3)}),f.addEventListener("click",function(){return X(5)}),b.addEventListener("click",function(){x.style.display="none",g.style.display="block",function(t){var e=document.getElementById("increase-btn"),n=document.getElementById("decrease-btn"),i=document.getElementById("dimension-input"),o="3";function s(){parseInt(i.value)<=9&&(i.value=String(parseInt(i.value)+1))}function r(){parseInt(i.value)>3&&(i.value=String(parseInt(i.value)-1))}i.addEventListener("blur",function(){var t=i.value.trim();if(m.test(t)){var e=parseInt(t);e>=3&&e<=10?o=e.toString():i.value=o.toString()}else i.value=o}),e.addEventListener("click",s),n.addEventListener("click",r),document.getElementById("play-btn").addEventListener("click",function(){t(parseInt(i.value)),e.removeEventListener("click",s),n.removeEventListener("click",r)},{once:!0})}(X)})})();